(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-277f88a8"],{"4f12":function(e,t,a){},"6cab":function(e,t,a){"use strict";var o=a("4f12"),n=a.n(o);n.a},"8bea":function(e,t,a){},"90e9":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"carManager"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 优惠券管理\n      ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.addVisible=!0}}},[e._v("添加")]),a("el-button",{staticClass:"sousuo",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.refresh}},[e._v("刷新")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center","class-name":"table"}}),a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号","class-name":"table"}}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center","class-name":"table"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleadd(t.$index,t.row)}}},[e._v("充值")]),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])}),a("el-table-column",{attrs:{prop:"names",label:"优惠券类型","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponName",label:"优惠券名称","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponStarttime",label:"开始时间","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponEndtime",label:"结束时间","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponParkingName",label:"停车场","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponBcName",label:"商户","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponAreaName",label:"区域","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponCount",label:"优惠券总数量","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponDataA",label:"优惠券剩余数量","class-name":"table"}}),a("el-table-column",{attrs:{prop:"jcgReliefAlltime",label:"减免总时长","class-name":"table"}}),a("el-table-column",{attrs:{prop:"jcgReliefRemaintime",label:"减免剩余时长","class-name":"table"}}),a("el-table-column",{attrs:{prop:"jcgReliefAllmoney",label:"减免总金额","class-name":"table"}}),a("el-table-column",{attrs:{prop:"jcgReliefRemainmoney",label:"减免剩余金额","class-name":"table"}}),a("el-table-column",{attrs:{prop:"couponDataB",label:"备注","class-name":"table"}})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.cur_page,"page-size":e.pagesize,total:e.totalRecords,"page-sizes":[5,10,20,40],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:"充值",visible:e.addnewVisible,width:"30%"},on:{"update:visible":function(t){e.addnewVisible=t}}},[a("el-form",{ref:"addnewForm",attrs:{model:e.addnewForm,rules:e.carFormRulese,"label-width":"100px"}},[a("el-form-item",{attrs:{label:e.typenames,prop:"couponCount"}},[a("el-input",{model:{value:e.addnewForm.couponCount,callback:function(t){e.$set(e.addnewForm,"couponCount",t)},expression:"addnewForm.couponCount"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addnewVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addSure}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加",visible:e.addVisible,width:"30%"},on:{"update:visible":function(t){e.addVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.carFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"优惠券名称",prop:"couponName "}},[a("el-input",{attrs:{placeholder:"请输入优惠券名称"},model:{value:e.addForm.couponName,callback:function(t){e.$set(e.addForm,"couponName",t)},expression:"addForm.couponName "}})],1),a("el-form-item",{attrs:{label:"优惠券类型",prop:"couponCount"}},[a("el-select",{on:{change:function(t){return e.chooseCoupon()}},model:{value:e.addForm.jcgType,callback:function(t){e.$set(e.addForm,"jcgType",t)},expression:"addForm.jcgType"}},e._l(e.couponType,function(e){return a("el-option",{key:e.id,attrs:{label:e.value,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"优惠券数量",prop:"couponCount"}},[a("el-input",{attrs:{placeholder:"请先选择优惠券类型，输入需要生成的优惠券数量",disabled:e.flagNum},model:{value:e.addForm.couponCount,callback:function(t){e.$set(e.addForm,"couponCount",t)},expression:"addForm.couponCount"}})],1),a("el-form-item",{attrs:{label:"减免时长",prop:"time"}},[a("el-input",{attrs:{placeholder:"减免时长（小时）",disabled:e.flagTime},model:{value:e.addForm.jcgReliefTime,callback:function(t){e.$set(e.addForm,"jcgReliefTime",t)},expression:"addForm.jcgReliefTime"}})],1),a("el-form-item",{attrs:{label:"减免金额",prop:"money"}},[a("el-input",{attrs:{placeholder:"减免金额（元）",disabled:e.flagMoney},model:{value:e.addForm.jcgReliefMoney,callback:function(t){e.$set(e.addForm,"jcgReliefMoney",t)},expression:"addForm.jcgReliefMoney"}})],1),a("el-form-item",{attrs:{label:"开始日期",prop:"couponStarttime"}},[a("el-date-picker",{attrs:{type:"datetime","picker-options":{selectableRange:"00:00:00 - 23:59:59"},placeholder:"选择日期"},model:{value:e.addForm.couponStarttime,callback:function(t){e.$set(e.addForm,"couponStarttime",t)},expression:"addForm.couponStarttime"}})],1),a("el-form-item",{attrs:{label:"结束日期",prop:"couponEndtime"}},[a("el-date-picker",{attrs:{type:"datetime","picker-options":{selectableRange:"23:59:59 - 23:59:59"},placeholder:"选择日期"},model:{value:e.addForm.couponEndtime,callback:function(t){e.$set(e.addForm,"couponEndtime",t)},expression:"addForm.couponEndtime"}})],1),a("el-form-item",{attrs:{label:"停车场",prop:"couponParkingName"}},[a("el-select",{attrs:{placeholder:"停车场",disabled:""},model:{value:e.addForm.couponParkingName,callback:function(t){e.$set(e.addForm,"couponParkingName",t)},expression:"addForm.couponParkingName"}},e._l(e.parking,function(e){return a("el-option",{key:e.couponParkingName,attrs:{label:e.couponParkingName,value:e.couponParkingName}})}),1)],1),a("el-form-item",{attrs:{label:"区域",prop:"couponAreaName"}},[a("el-select",{attrs:{placeholder:"区域"},on:{change:e.hand},model:{value:e.addForm.couponAreaName,callback:function(t){e.$set(e.addForm,"couponAreaName",t)},expression:"addForm.couponAreaName"}},e._l(e.area,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"商户",prop:"couponBcName"}},[a("el-select",{attrs:{placeholder:"商户"},model:{value:e.addForm.couponBcName,callback:function(t){e.$set(e.addForm,"couponBcName",t)},expression:"addForm.couponBcName"}},e._l(e.bc,function(e){return a("el-option",{key:e.couponBcName,attrs:{label:e.couponBcName,value:e.couponBcName}})}),1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.addForm.couponDataB,callback:function(t){e.$set(e.addForm,"couponDataB",t)},expression:"addForm.couponDataB"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveAdd}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改用户权限",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.carFormRuleess,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"优惠券名称",prop:"couponName"}},[a("el-input",{attrs:{disabled:"",placeholder:"请输入优惠券名称"},model:{value:e.editForm.couponName,callback:function(t){e.$set(e.editForm,"couponName",t)},expression:"editForm.couponName"}})],1),a("el-form-item",{attrs:{label:"全免券数量",prop:"couponCount"}},[a("el-input",{attrs:{disabled:"",placeholder:"请输入全免券数量"},model:{value:e.editForm.couponDataA,callback:function(t){e.$set(e.editForm,"couponDataA",t)},expression:"editForm.couponDataA "}})],1),a("el-form-item",{attrs:{label:"开始日期",prop:"couponStarttime"}},[a("el-date-picker",{attrs:{type:"datetime","picker-options":{selectableRange:"00:00:00 - 23:59:59"},placeholder:"选择日期"},model:{value:e.editForm.couponStarttime,callback:function(t){e.$set(e.editForm,"couponStarttime",t)},expression:"editForm.couponStarttime"}})],1),a("el-form-item",{attrs:{label:"结束日期",prop:"couponEndtime"}},[a("el-date-picker",{attrs:{type:"datetime","picker-options":{selectableRange:"23:59:59 - 23:59:59"},placeholder:"选择日期"},model:{value:e.editForm.couponEndtime,callback:function(t){e.$set(e.editForm,"couponEndtime",t)},expression:"editForm.couponEndtime"}})],1),a("el-form-item",{attrs:{label:"停车场",prop:"couponParkingName"}},[a("el-select",{attrs:{placeholder:"停车场",disabled:""},model:{value:e.editForm.couponParkingName,callback:function(t){e.$set(e.editForm,"couponParkingName",t)},expression:"editForm.couponParkingName"}},e._l(e.parking,function(e){return a("el-option",{key:e.couponParkingName,attrs:{label:e.couponParkingName,value:e.couponParkingName}})}),1)],1),a("el-form-item",{attrs:{label:"区域",prop:"couponAreaName"}},[a("el-select",{attrs:{disabled:"",placeholder:"区域"},model:{value:e.editForm.couponAreaName,callback:function(t){e.$set(e.editForm,"couponAreaName",t)},expression:"editForm.couponAreaName"}},e._l(e.area,function(e){return a("el-option",{key:e.couponAreaName,attrs:{label:e.couponAreaName,value:e.couponAreaName}})}),1)],1),a("el-form-item",{attrs:{label:"商户",prop:"couponBcName"}},[a("el-select",{attrs:{placeholder:"商户",disabled:""},model:{value:e.editForm.couponBcName,callback:function(t){e.$set(e.editForm,"couponBcName",t)},expression:"editForm.couponBcName"}},e._l(e.bc,function(e){return a("el-option",{key:e.couponBcName,attrs:{label:e.couponBcName,value:e.couponBcName}})}),1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.editForm.couponDataB,callback:function(t){e.$set(e.editForm,"couponDataB",t)},expression:"editForm.couponDataB"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)])],1)},n=[],i=(a("c5f6"),a("7f7f"),a("a15e"),{name:"carManager",data:function(){var e=this,t=function(t,a,o){var n=new Date(e.editForm.couponStarttime),i=n.getTime(),l=new Date(e.editForm.couponEndtime),r=l.getTime();console.log(i),console.log(r),i>r?(o(new Error("结束时间不能早与开始时间")),console.log("12")):(o(),console.log("13"))},a=function(t,a,o){var n=new Date(e.addForm.couponStarttime),i=n.getTime(),l=new Date(e.addForm.couponEndtime),r=l.getTime();console.log(i),console.log(r),i>r?(o(new Error("结束时间不能早与开始时间")),console.log("12")):(o(),console.log("13"))};return{bc:[],agent:[],area:[],parking:[],tableData:[],cur_page:1,pagesize:20,totalRecords:0,totalPages:0,multipleSelection:[],select_cate:"",select_word:"",del_list:[],typenames:"",is_search:!1,addnewVisible:!1,editVisible:!1,addVisible:!1,delVisible:!1,addForm:{couponId:"",couponName:"",couponType:"",couponCount:"",couponStarttime:"",couponEndtime:"",couponBcName:"",jcgType:"",jcgReliefTime:"",jcgReliefMoney:"",couponParkingName:"",couponAreaName:"",couponDataB:"",jcgReliefAlltime:"",jcgReliefRemaintime:"",jcgReliefAllmoney:"",jcgReliefRemainmoney:""},editForm:{couponId:"",couponName:"",couponType:"",couponCount:"",couponStarttime:"",couponEndtime:"",couponBcName:"",couponParkingName:"",couponAreaName:"",couponDataA:"",couponDataB:"",jcgReliefAlltime:"",jcgReliefRemaintime:"",jcgReliefAllmoney:"",jcgReliefRemainmoney:""},addnewForm:{couponId:"",couponCount:""},carFormRules:{couponBcName:[{required:!0,message:"请输入优惠券名称",trigger:"blur"},{min:1,max:20,message:"名称应在20字节以内",trigger:"blur"}],couponEndtime:[{required:!0,message:"请输入结束时间",trigger:"blur"},{validator:a,trigger:"blur"}]},carFormRuleess:{couponEndtime:[{required:!0,message:"请输入结束时间",trigger:"blur"},{validator:t,trigger:"blur"}]},carFormRulese:{couponCount:[{required:!0,message:"请输入充值优惠券数量",trigger:"blur"},{pattern:/^\+?[1-9]\d*$/,message:"请输入正确的数量"}]},options:[],value:"",idx:-1,id:-1,flagTime:!0,flagMoney:!0,flagNum:!0,couponType:[{id:0,value:"全免券"},{id:1,value:"减免时长"},{id:2,value:"减免金额"},{id:3,value:"当天有效全免券"}]}},created:function(){this.getData(),this.getAgent(),this.getArea(),this.getParking();new Date},computed:{data:function(){var e=this;return this.tableData.filter(function(t){for(var a=!1,o=0;o<e.del_list.length;o++)if(t.name===e.del_list[o].name){a=!0;break}if(!a&&t.address.indexOf(e.select_cate)>-1&&(t.name.indexOf(e.select_word)>-1||t.address.indexOf(e.select_word)>-1))return t})}},methods:{chooseCoupon:function(){"减免时长"==this.addForm.jcgType?(this.flagTime=!1,this.flagMoney=!0,this.flagNum=!0):"减免金额"==this.addForm.jcgType?(this.flagMoney=!1,this.flagTime=!0,this.flagNum=!0):(this.flagTime=!0,this.flagMoney=!0,this.flagNum=!1)},refresh:function(){this.getData(),this.getAgent(),this.getArea(),this.getParking(),this.editForm={},this.select_word="",this.addForm={}},timestampToTime:function(e){var t=new Date(e),a=t.getFullYear()+"-",o=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",n=t.getDate()+" ",i=t.getHours()>10?t.getHours():"0"+t.getHours(),l=t.getMinutes()>10?t.getMinutes():"0"+t.getMinutes(),r=t.getSeconds()>10?t.getSeconds():"0"+t.getSeconds();return a+o+n+i+":"+l+":"+r},hand:function(e){var t=this;this.$axios({url:"JinshiBusinessAccount/selectAllBusinessName",method:"post",data:{areaId:Number(e),parkId:String(localStorage.getItem("parkId"))}}).then(function(e){console.log(e),t.bc=[];for(var a=0;a<e.data.BusinessNameData.length;a++)t.bc.push({couponBcName:e.data.BusinessNameData[a].bcName})}).catch(function(e){t.$message.error("查询失败: "+e)})},dateChangebirthdayC:function(e){console.log(e),this.addForm.couponStarttime=e,this.editForm.couponStarttime=e},dateChangebirthdayD:function(e){console.log(e),this.editForm.couponEndtime=e},dateFormatterexpirationTime:function(e,t){var a=e.expirationTime;if(a){a=new Date(a);var o=a.getFullYear()+"-",n=a.getMonth()+1+"-",i=a.getDate();return o+n+i}return""},dateFormatter:function(e,t){var a=e.joinTime;if(a){a=new Date(a);var o=a.getFullYear()+"-",n=a.getMonth()+1+"-",i=a.getDate();return o+n+i}return""},handleSizeChange:function(e){this.pagesize=e,this.getData()},handleCurrentChange:function(e){this.cur_page=e,this.getData()},getData:function(){var e=this;this.$axios({url:"JinshiCoupon/selectCouponAll",method:"post",data:{pageNum:e.cur_page,pageSize:e.pagesize,parkId:String(localStorage.getItem("parkId"))}}).then(function(t){if(console.log(t,"1111111111111111111"),t.status<=200){console.log(t.data.CouponData);for(var a=0;a<t.data.CouponData.length;a++)t.data.CouponData[a]["names"]="";for(var o=0;o<t.data.CouponData.length;o++)0==t.data.CouponData[o].couponType?t.data.CouponData[o].names="全免劵":1==t.data.CouponData[o].couponType?t.data.CouponData[o].names="减免时长":2==t.data.CouponData[o].couponType?t.data.CouponData[o].names="减免金额":3==t.data.CouponData[o].couponType&&(t.data.CouponData[o].names="当天有效全免劵");for(var n=0;n<t.data.CouponData.length;n++)t.data.CouponData[n].couponEndtime&&(t.data.CouponData[n].couponEndtime=e.timestampToTime(t.data.CouponData[n].couponEndtime)),t.data.CouponData[n].couponStarttime&&(t.data.CouponData[n].couponStarttime=e.timestampToTime(t.data.CouponData[n].couponStarttime)),e.tableData=t.data.CouponData,e.totalRecords=t.data.CouponRecords}}).catch(function(t){e.$message.error("查询失败: "+t),console.log(t)})},getAgent:function(){this.agent.length=0;var e=this;this.$axios({url:"parkingJinshi/selectAllAgent",method:"post",data:{}}).then(function(t){e.agent=[];for(var a=0;a<t.data.agentNameData.length;a++)e.agent.push({couponAgentName:t.data.agentNameData[a].username})}).catch(function(t){e.$message.error("查询失败: "+t)})},getArea:function(){this.area.length=0;var e=this;this.$axios({url:"jinshiArea/selectAreaNameAll?parkId="+localStorage.getItem("parkId"),method:"get",data:{}}).then(function(t){e.area=[];for(var a=0;a<t.data.areaNameData.length;a++)e.area.push({value:t.data.areaNameData[a].id,label:t.data.areaNameData[a].areaName});console.log(e.area)}).catch(function(t){e.$message.error("查询失败: "+t)})},getParking:function(){this.parking.length=0;var e=this;this.$axios({url:"parkingJinshi/selectAllParkingName",method:"post",data:{}}).then(function(t){e.parking=[];for(var a=0;a<t.data.parkingNameData.length;a++)e.parking.push({couponParkingName:t.data.parkingNameData[a].jpName}),e.addForm.couponParkingName=t.data.parkingNameData[a].jpName}).catch(function(t){e.$message.error("查询失败: "+t)})},formatter:function(e,t){return e.address},filterTag:function(e,t){return t.tag===e},handleadd:function(e,t){this.idx=e,this.id=t.couponId,console.log("====",t.couponType),0==t.couponType?this.typenames="请输入需要充值全免劵的数量":1==t.couponType?this.typenames="请输入需要充值减免时长的时间":2==t.couponType?this.typenames="请输入需要充值减免金额的金额":3==t.couponType&&(this.typenames="请输入需要充值当天全免劵的数量");var a=t.couponId,o=Number(t.couponType);console.log(o),console.log(t.couponId),this.addnewForm={jcgType:o,couponId:a,couponCount:"",jcgReliefAlltime:"",jcgReliefAllmoney:""},this.addnewVisible=!0},handleEdit:function(e,t){this.idx=e,this.id=t.couponId,console.log(t),this.editForm={couponId:t.couponId,couponName:t.couponName,couponType:t.couponType,couponCount:t.couponCount,couponStarttime:t.couponStarttime,couponEndtime:t.couponEndtime,couponBcName:t.couponBcName,couponAgentName:t.couponAgentName,couponParkingName:t.couponParkingName,couponAreaName:t.couponAreaName,couponDataA:t.couponDataA,jcgReliefAlltime:t.jcgReliefAlltime,jcgReliefRemaintime:t.jcgReliefRemaintime,jcgReliefAllmoney:t.jcgReliefAllmoney,jcgReliefRemainmoney:t.jcgReliefRemainmoney};var a=new Date,o=a.getFullYear()+"-",n=a.getMonth()+1+"-",i=a.getDate(),l=a.getHours()+":";l=l<10?"0"+l:l;var r=a.getMinutes()+":";r=r<10?"0"+r:r;var s=a.getSeconds();s=s<10?"0"+s:s,this.editForm.couponStarttime=o+n+i,this.editVisible=!0},addSure:function(){var e=this;console.log(this.typenames),"请输入需要充值减免时长的时间"==this.typenames?(this.addnewForm.jcgReliefAlltime=this.addnewForm.couponCount,this.addnewForm.couponCount="",this.addnewForm.jcgReliefAllmoney=""):"请输入需要充值减免金额的金额"==this.typenames?(this.addnewForm.jcgReliefAllmoney=this.addnewForm.couponCount,this.addnewForm.jcgReliefAlltime="",this.addnewForm.couponCount=""):(this.addnewForm.couponCount=this.addnewForm.couponCount,this.addnewForm.jcgReliefAllmoney="",this.addnewForm.jcgReliefAlltime="");var t=this,a=this.addnewForm;console.log(a),this.$refs.addnewForm.validate(function(o){o?e.$axios({url:"JinshiCoupon/updateCouponCount",method:"post",data:a}).then(function(e){if(e.status<=200){if(t.addnewVisible=!1,t.$message.success("充值成功"),t.tableData[t.idx].id===t.id)t.$set(t.tableData,t.idx,t.addnewForm);else for(var a=0;a<t.tableData.length;a++)if(t.tableData[a].id===t.id)return void t.$set(t.tableData,a,t.addnewForm);t.getData()}}).catch(function(e){t.$message.error("充值失败！"),console.log(e)}):t.$message.success("格式不正确")})},saveEdit:function(){var e=this,t=new Date(this.editForm.couponStarttime),a=t.getFullYear()+"-",o=t.getMonth()+1+"-",n=t.getDate(),i=t.getHours()+":";i=i<10?"0"+i:i;var l=t.getMinutes()+":";l=l<10?"0"+l:l;var r=t.getSeconds();if(r=r<10?"0"+r:r,this.editForm.couponStarttime=a+o+n+" 00:00:00",console.log(this.editForm.couponEndtime),void 0==this.editForm.couponEndtime)this.editForm.couponEndtime="0",console.log(this.editForm.couponEndtime);else{var s=new Date(this.editForm.couponEndtime),c=s.getFullYear()+"-",d=s.getMonth()+1+"-",u=s.getDate(),m=s.getHours()+":";m=m<10?"0"+m:m;var p=s.getMinutes()+":";p=p<10?"0"+p:p;var g=s.getSeconds();g=g<10?"0"+g:g,this.editForm.couponEndtime=c+d+u+" 23:59:59",console.log("5555555",this.editForm.couponEndtime)}var h=this,f=this.editForm;console.log(f),this.$refs.editForm.validate(function(t){t?e.$axios({url:"JinshiCoupon/updateByPrimaryKey",method:"post",data:f}).then(function(e){if(e.status<=200){if(h.editVisible=!1,h.$message.success("修改成功"),h.$message.success("修改第 ".concat(h.idx+1," 行成功")),h.tableData[h.idx].id===h.id)h.$set(h.tableData,h.idx,h.editForm);else for(var t=0;t<h.tableData.length;t++)if(h.tableData[t].id===h.id)return void h.$set(h.tableData,t,h.editForm);h.getData()}}).catch(function(e){h.$message.error("修改失败！"),console.log(e)}):h.$message.success("格式不正确")})},handleDelete:function(e,t){this.idx=e,this.id=t.couponId,console.log(this.id),this.delVisible=!0},delAll:function(){var e=this.multipleSelection.length,t="";this.del_list=this.del_list.concat(this.multipleSelection);for(var a=0;a<e;a++)t+=this.multipleSelection[a].name+" ";this.$message.success("删除了"+t),this.multipleSelection=[]},handleSelectionChange:function(e){this.multipleSelection=e},saveAdd:function(){var e=this;switch(this.addForm.jcgType){case"全免券":this.addForm.jcgType=0;break;case"减免时长":this.addForm.jcgType=1;break;case"减免金额":this.addForm.jcgType=2;break;case"当天有效全免券":this.addForm.jcgType=3;break}if(console.log(this.addForm.passWord,this.addForm.passwordsure),1==this.addForm.jcgType?(this.addForm.jcgReliefAlltime=Number(this.addForm.jcgReliefTime),this.addForm.jcgReliefAllmoney="",this.addForm.couponCount="",console.log(this.addForm.jcgReliefAlltime,"aaaa")):2==this.addForm.jcgType?(this.addForm.jcgReliefAllmoney=Number(this.addForm.jcgReliefMoney),this.addForm.jcgReliefAlltime="",this.addForm.couponCount=""):3==this.addForm.jcgType?(this.addForm.jcgReliefAllmoney="",this.addForm.jcgReliefAlltime=""):0==this.addForm.jcgType&&(this.addForm.jcgReliefAllmoney="",this.addForm.jcgReliefAlltime=""),this.addForm.passWord==this.addForm.passwordsure){var t=this;t.addForm.rolename=t.value,t.addForm.couponAgentName=localStorage.getItem("agentId");for(var a=0;a<this.area.length;a++)this.area[a].value==this.addForm.couponAreaName&&(this.addForm.couponAreaName=this.area[a].label);var o=new Date,n=o.getFullYear()+"-",i=o.getMonth()+1+"-",l=o.getDate(),r=o.getHours()+":";r=r<10?"0"+r:r;var s=o.getMinutes()+":";s=s<10?"0"+s:s;var c=o.getSeconds();if(c=c<10?"0"+c:c,this.addForm.couponStarttime=n+i+l+" 00:00:00",console.log(this.addForm.couponEndtime),""==this.addForm.couponEndtime)this.addForm.couponEndtime="",console.log(this.addForm.couponEndtime);else{var d=new Date(this.addForm.couponEndtime),u=d.getFullYear()+"-",m=d.getMonth()+1+"-",p=d.getDate(),g=d.getHours()+":";g=g<10?"0"+g:g;var h=d.getMinutes()+":";h=h<10?"0"+h:h;var f=d.getSeconds();f=f<10?"0"+f:f,this.addForm.couponEndtime=u+m+p+" "+g+h+f,console.log("5555555",this.addForm.couponEndtime)}var b=this.addForm;console.log(b,"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"),this.$refs.addForm.validate(function(a){a?e.$axios({url:"JinshiCoupon/insert",method:"post",data:b}).then(function(e){e.status<=200&&(1==e.data.code?t.$message.error("用户名已存在"):(t.addVisible=!1,t.$message.success("添加成功"),t.getData()))}).catch(function(e){t.$message.error("添加失败！"),console.log(e)}):t.$message.success("格式不正确")})}else alert("两次密码不一致")},deleteRow:function(){var e=this;this.$axios({url:"JinshiCoupon/deleteByPrimaryKey?id="+e.id,method:"post",data:{id:e.id}}).then(function(t){if(t.status<=200)if(e.$message.success("删除成功"),e.getData(),e.delVisible=!1,e.tableData[e.idx].id===e.id)e.tableData.splice(e.idx,1);else for(var a=0;a<e.tableData.length;a++)if(e.tableData[a].id===e.id)return void e.tableData.splice(a,1)}).catch(function(t){e.$message.success("删除失败！"),console.log(t)})}}}),l=i,r=(a("ddb2"),a("6cab"),a("2877")),s=Object(r["a"])(l,o,n,!1,null,"a57da614",null);t["default"]=s.exports},ddb2:function(e,t,a){"use strict";var o=a("8bea"),n=a.n(o);n.a}}]);